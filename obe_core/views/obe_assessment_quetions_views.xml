<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_obe_assessment_question_list" model="ir.ui.view">
        <field name="name">obe.assessment.question.list</field>
        <field name="model">obe.assessment.question</field>
        <field name="arch" type="xml">
            <list string="Questions">
                <field name="sequence" widget="handle"/>
                <field name="question_number"/>
                <field name="question_text"/>
                <field name="marks"/>
                <field name="clo_id" options="{'no_create': True}"/>
                <field name="bloom_level"/>
                <field name="question_type" optional="hide"/>
                <field name="difficulty_level" optional="hide"/>
                <field name="average_marks_obtained" optional="hide"/>
                <field name="attainment_percentage" widget="percentage" optional="hide"/>
            </list>
        </field>
    </record>

    <record id="view_obe_assessment_question_form" model="ir.ui.view">
        <field name="name">obe.assessment.question.form</field>
        <field name="model">obe.assessment.question</field>
        <field name="arch" type="xml">
            <form string="Question">
                <header>
                    <field name="state" widget="statusbar" statusbar_visible="draft,active" readonly="1"/>
                    <button name="action_active" string="Activate" type="object" 
                            class="oe_highlight" icon="fa-check" 
                            invisible="state != 'draft'" 
                            confirm="Are you sure you want to activate this CLO?"/>
                    <button name="action_draft" string="Reset to Draft" type="object" 
                            class="btn-secondary" icon="fa-undo" 
                            invisible="state != 'active'"
                            confirm="Are you sure you want to reset this CLO to draft?"/>
                </header>

                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="question_number" placeholder="Question Number (e.g., Q1, 1a)"/>
                        </h1>
                    </div>
                    
                    <group>
                        <group name="question_info">
                            <field name="marks"/>
                            <field name="clo_id" options="{'no_create': True}"/>
                            <field name="bloom_level"/>
                        </group>
                        <group name="classification">
                            <field name="question_type"/>
                            <field name="difficulty_level"/>
                        </group>
                    </group>
                    
                    <group string="Question Text">
                        <field name="question_text" nolabel="1" placeholder="Enter the question..."/>
                    </group>
                    
                    <notebook>
                        <page string="Solution" name="solution">
                            <field name="solution" nolabel="1"/>
                        </page>
                        <page string="Grading Rubric" name="rubric">
                            <field name="rubric" nolabel="1"/>
                        </page>
                        <page string="Hints" name="hints">
                            <field name="hints" nolabel="1" placeholder="Optional hints for students..."/>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>
    
    <record id="view_obe_assessment_question_search" model="ir.ui.view">
        <field name="name">obe.assessment.question.search</field>
        <field name="model">obe.assessment.question</field>
        <field name="arch" type="xml">
            <search string="Search Questions">
                <field name="question_number"/>
                <field name="question_text"/>
                <field name="assessment_id"/>
                <field name="clo_id"/>
                
                <filter string="Remember" name="remember" domain="[('bloom_level', '=', 'remember')]"/>
                <filter string="Understand" name="understand" domain="[('bloom_level', '=', 'understand')]"/>
                <filter string="Apply" name="apply" domain="[('bloom_level', '=', 'apply')]"/>
                <filter string="Analyze" name="analyze" domain="[('bloom_level', '=', 'analyze')]"/>
                <filter string="Evaluate" name="evaluate" domain="[('bloom_level', '=', 'evaluate')]"/>
                <filter string="Create" name="create" domain="[('bloom_level', '=', 'create')]"/>
                
                <separator/>
                <filter string="Easy" name="easy" domain="[('difficulty_level', '=', 'easy')]"/>
                <filter string="Medium" name="medium" domain="[('difficulty_level', '=', 'medium')]"/>
                <filter string="Hard" name="hard" domain="[('difficulty_level', '=', 'hard')]"/>
                
                <group expand="0" string="Group By">
                    <filter string="Assessment" name="group_assessment" context="{'group_by': 'assessment_id'}"/>
                    <filter string="CLO" name="group_clo" context="{'group_by': 'clo_id'}"/>
                    <filter string="Bloom Level" name="group_bloom" context="{'group_by': 'bloom_level'}"/>
                    <filter string="Question Type" name="group_type" context="{'group_by': 'question_type'}"/>
                    <filter string="Difficulty" name="group_difficulty" context="{'group_by': 'difficulty_level'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Assessment Question Action -->
    <record id="action_obe_assessment_question" model="ir.actions.act_window">
        <field name="name">Assessment Questions</field>
        <field name="res_model">obe.assessment.question</field>
        <field name="view_mode">list,form</field>
        <field name="search_view_id" ref="view_obe_assessment_question_search"/>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first Question
            </p>
            <p>
                Define questions with granular CLO mapping and Bloom's taxonomy level
                for comprehensive attainment tracking.
            </p>
        </field>
    </record>
    
    <!-- Menu Item for Questions -->
    <menuitem id="menu_obe_assessment_question" 
              name="Questions" 
              parent="menu_obe_assessment_root" 
              action="action_obe_assessment_question" 
              sequence="20"/>
    
</odoo>